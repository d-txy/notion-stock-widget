<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>动态股票行情 | TradingView</title>
    <!-- 隐藏页面边框和滚动条，适配Notion嵌入 -->
    <style>
        body { margin: 0; padding: 0; overflow: hidden; }
        .tradingview-widget-container { width: 100%; height: 100vh; }
        /* 可选：隐藏TradingView水印（需遵守其服务条款） */
        .tv-watermark { display: none !important; }
    </style>
</head>
<body>
    <!-- TradingView小部件容器 -->
    <div class="tradingview-widget-container">
        <div id="tradingview_chart"></div>
    </div>

    <!-- 引入TradingView脚本 -->
    <script src="https://s3.tradingview.com/tv.js"></script>
    <script>
        // 1. 从URL中获取股票代码参数（如 ?symbol=NASDAQ:AAPL）
        function getUrlParam(name) {
            const reg = new RegExp(`(^|&)${name}=([^&]*)(&|$)`);
            const r = window.location.search.substr(1).match(reg);
            return r ? decodeURIComponent(r[2]) : 'NASDAQ:AAPL'; // 默认显示苹果股票
        }

        // 2. 动态获取股票代码
        const stockSymbol = getUrlParam('symbol');

        // 3. 初始化TradingView图表（支持自定义配置）
        new TradingView.widget({
            "width": "100%",
            "height": "100%",
            "symbol": stockSymbol, // 动态传入股票代码
            "interval": "D", // 默认日线（可改为1H、1M等）
            "timezone": "Asia/Shanghai", // 时区（中国用户用上海）
            "theme": "light", // 主题（light/dark）
            "style": "1", // 图表样式
            "locale": "zh_CN", // 中文显示
            "toolbar_bg": "#f1f3f6",
            "enable_publishing": false, // 禁用分享
            "allow_symbol_change": true, // 允许在图表中切换股票
            "container_id": "tradingview_chart" // 绑定容器
        });
    </script>
</body>
</html>
